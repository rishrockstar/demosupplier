<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Fields from Google Sheets</title>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<h2>Create Agreement</h2>
<h4>Supplier Agreement</h4>
<body>
    <div id="dynamicFieldsContainer"></div>

    <script>
        // Load the Google Sheets API
        gapi.load('client', initClient);

        // Function to initialize the Google Sheets API client
        function initClient() {
            gapi.client.init({
                apiKey: 'AIzaSyBo4KSquNH5NOdkUUfiIaJe123DkpfP_W8', // Replace with your API key
                discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
    }).then(() => {
      handleSheetData();
    });
  }

  function handleSheetData() {
    const spreadsheetId = '11sHPQgVOiS32WQpBcQG0q1kLI9LLFBs6pmeIsopAvj0';
    const range = 'ContractTypeAttributes';

    gapi.client.sheets.spreadsheets.values.get({
      spreadsheetId,
      range,
    }).then(response => {
      const data = response.result.values;

      if (data) {
        const labels = data.map(entry => entry[2]); // Assuming ICMDisplayName is in the first column
        const fields = data.map(entry => entry[4]); // Assuming DataType is in the second column

        createDynamicForm(labels, fields);
      } else {
        console.error('No data found in the sheet');
      }
    });
  }

  function createDynamicForm(labels, fields) {
    const formContainer = document.createElement('div');
    formContainer.id = 'dynamicForm';

    labels.forEach((label, index) => {
      const formField = document.createElement('div');

      const labelElement = document.createElement('label');
      labelElement.textContent = label;

      const input = document.createElement('input');
      input.type = 'text';
      input.name = label; // You may want to adjust this based on your specific needs
      input.value = fields[index];

      formField.appendChild(labelElement);
      formField.appendChild(input);

      formContainer.appendChild(formField);
    });

    document.body.appendChild(formContainer);
  }
</script>

<script async defer src="https://apis.google.com/js/api.js"></script>

</body>
</html>
